В данном проекте представлена нейронка, разработанная командой "ЭП момент" в рамках хакатона IT Nuclear Hack.

Зависимости:
python 3.10 и выше, opencv (opencv-python), deepface, matplotlib

Персональные рекомендации:
Запускать на Ubutnu 22.04 (или любом Linux с поддержкой .deb, включая Debian и отечественный AstraLinux) и через консоль 

Идея: используем Каскад Хаара. Каскад Хаара -  это алгоритм машинного обучения, который часто используется для обнаружения объектов на изображениях. Он был разработан Паулем Виолой и Михаэлем Джонсом в 2001 году и получил широкое распространение благодаря своей эффективности в обнаружении лиц. Алгоритм каскада Хаара использует особые признаки, называемые признаками Хаара, для определения присутствия объекта в изображении. Эти признаки представляют собой простые шаблоны, которые описывают различные характеристики объектов, такие как края, углы, и изменения яркости. Алгоритм обучается на большом наборе изображений, содержащих объекты, которые нужно обнаружить.

Распознаваемые эмоции: спокойствие ("neutral"), страх("fear"), удивление("surprise"), радость("happy"), злость("angry")

Особенности работы с видео: возможость анализа видео или стрима с веб-камера (выбор реализуется с помощью диалогового интерфейса с пользователем), возможность делать скриншоты из видео встроенной кнопкой и сохранять их в память/буфер обмена, возможность приближать и удалять видео (в т.ч. и в live), выведение усреднённого rgb-разбиения для групп пикселей. 

Общие фичи: непрерывный вывод в консоль эмоциального фона акторов, получение общего эмоционального фона встречи и построение на его основе круговой диаграммы. 

Особенности работы с графиком эмоциального фона: возможность масштабирования графика, сохранения его в память.

Плюсы проекта: каскад Хаара обучается легче, чем CNN или RNN, тратит меньше мощностей, но в то же время даёт практически сопоставимый результат; в то же время он точнее KNN, который требует схожих вычислительных мощностей; дешевизна - внедрение подобного распознавания лиц не требует высоких затрат; наличие большого количества датасетов для распознавания лиц, что упрощает обучение/переобучение модели в долгосрочной перспективе.

Описание файлов: 

haarcascade_frontalface_default.xml - файл с данными для каскада Хаара, который и отвечает за распознавание лиц

main.py - основной файл, который и необходимо запускать. Содержит в себе сам алгоритмы отрисовки прямоугольников для лиц, выведения эмоций в live, хранения общего эмоциального фона и построения на его основе круговой диаграммы, которые развёртывает при запуске.

Краткое описание решения:

Импортируются библиотеки opencv, deepface, matplotlib. Далее с помощью диалогового интерфейса определяется потребность пользователя (анализ в видео/стриме с веб-камеры).В случае отсутствия камеры или видео выбрасывается техническая ошибка. В случае, если всё исправно, начинается разбиение видео/трансляции на 6 кадров в секунду (оптимальное значение). В процессе разбиения на кадрах находятся лица (каскадом Хаара + доп.анализом с помощью KNN для сокращения вычислительных расходов на ранних стадиях и для отрисовки), выделяются квадраты лиц, определяются эмоции, которые выводятся на кадр и логгируется параллельно в консоль, а также заносятся в ton - список (ака массив в Python), хранящий проявление эмоций в числовом виде. Стартовые значения всех элементов в ton равны 1 (а не 0), так как в противном случае построение диаграммы невозможны, но на видео длиннее 10 секунд эта погрешность незначительна) Проделывается это до окончания видео/трансляции/ручного прерывания. После этого доминирующая черта эмоционального фона логгируется в консоль, закрывается анализ видео и открывается matplotlib, отрисовывающий по данным круговую диаграмму эм.фона. Диаграмма закрывается нажатием на клавишу закрытия. 

P.S> Для выхода из анализа даннных в процессе работы необходимо нажать клавишу "1".
